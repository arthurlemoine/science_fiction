---
title: "Planets"
author: "Arthur LEMOINE"
format: html
editor: visual
execute: 
  echo: false
  warning: false
  error: false
---

```{r}
library(dplyr)
library(tidyr)
library(vroom)
library(ggplot2)
library(here)
library(knitr)

here::i_am("science_fiction.Rproj")
```

## Question 1

I clearly uploaded everything before reading but no worries it's fixed.

## Question 2

Link to github: https://github.com/arthurlemoine/science_fiction.git

## Question 3

```{r}
planets <- vroom(here("data", "PLANETS.csv"), na = '_')

head_df <- planets %>%
  head(n=10)

knitr::kable(head_df, digits = 0)
```

This dataset is made of `r nrow(planets)` planets described by `r ncol(planets)` variables.

BONUS: a nice table of the 10 first rows.

## Question 4

```{r}
summary_table <- tibble(
  Metric = c("Number of Observations", "Number of Variables", "Number of Missing Values", "Observations with Missing Values"),
  Value = c(
    nrow(planets),
    ncol(planets),
    sum((is.na(planets))),
    sum(rowSums(is.na(planets)) > 0)
  ))

knitr::kable(summary_table)
```

## Question 5

```{r}
filtered_data <- planets %>%
  filter(!is.na(`Radius (Earth)`) & !is.na(`Density (Earth)`))

ggplot(filtered_data, aes(x = `Density (Earth)`, y = `Radius (Earth)`)) +
  geom_point() +
  labs(title = "Radius of a Planet as a Function of Density",
       x = "Density (Earth)",
       y = "Radius (Earth)")
```

## Question 6

```{r}

# Filter out missing values in numerical variables
numerical_data <- planets %>%
  select_if(is.numeric)

# Apply operations to find extreme planets for all numerical variables
extreme_planets_table <- numerical_data %>%
  gather(key = "Variable", value = "Value") %>%
  group_by(Variable) %>%
  slice(c(which.max(Value), which.min(Value))) %>%
  mutate(Extreme = ifelse(row_number() == 1, "Maximum", "Minimum"))

# Print the table
kable(extreme_planets_table, format = "markdown", digits = 2)



```
